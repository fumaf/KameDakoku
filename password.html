<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <?!= HtmlService.createHtmlOutputFromFile('passwordStyle').getContent(); ?>
</head>
<script>
  const button_click = (value) => {
    let target = document.getElementById("login");
    let tes1 = document.getElementById("first") 
    let tes2 = document.getElementById("second")
    let tes3 = document.getElementById("third")
    let tes4 = document.getElementById("fourth")
    let style = target.style;
    let psss = tes1.value + tes2.value + tes3.value + tes4.value;
    if (value == psss) {
      target.href = "<?= getAppUrl() ?>?page=set&name=<?= name ?>&password=<?= password ?>";
      fourth.blur();
      console.log("URLセット")
      target.innerText = "ログイン";
      style.boxShadow = "6px 6px 3px #8697BC";
      style.backgroundColor="#295FD6";
      style.pointerEvents= "inherit";
      style.color="white";
      style.fontWeight="900";
      style.border="2px solid #295FD6";
      style.width="25vmin";
      style.transition=".3s";
    }else{
      target.innerText = "パスワードが間違っています。";
      tes1.value = ""
      tes2.value = ""
      tes3.value = ""
      tes4.value = ""
      first.focus();
      style.boxShadow = "none";
      style.backgroundColor="transparent";
      style.pointerEvents="none";
      style.color="#D6295E";
      style.fontWeight="300";
      style.border="none";
      style.width="100vmin";
      style.transition="none";
    }
  }

  const outFocus = () => {
    // focusがあたっている要素を取得
    const elem = document.activeElement;
    // 1文字入力したらフォーカスを外す
    if(elem.value.length >= 1) {
      elem.blur();
    }
  }

  const secondFocus = () => {
    second.focus();
  }

  const thirdFocus = () => {
    third.focus();
  }

  const fourthFocus = () => {
    fourth.focus();
  }
</script>

<header>
  かめ打刻
</header>

<body>
  <div class="name">
    <span><?= name ?></span>
  </div>
  <div class="password">
    <p class="passwordReq">4桁のパスワードを入力してください。</p>
    <div class="inputBox">
      <input id="first" maxlength="1" inputmode="tel" onkeyup="outFocus()" onblur="secondFocus()"/>
      <input id="second" maxlength="1" inputmode="tel" onkeyup="outFocus()"onblur="thirdFocus()"/>
      <input id="third" maxlength="1" inputmode="tel" onkeyup="outFocus()"onblur="fourthFocus()"/>
      <input id="fourth" maxlength="1" inputmode="tel" onkeyup="button_click(<?= password ?>);" onkeyup="outFocus()"/>
    </div>
    <a id="login">ログイン</a></br>
    <a class="passwordFor">パスワードを忘た場合</a>
  </div>

</body>

</html>
